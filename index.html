<!doctype html>
<html lang="lv">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>STILL Player — Web UI</title>

  <script src="https://cdn.tailwindcss.com"></script>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

  <link rel="stylesheet" href="./styles.css" />
</head>

<body class="min-h-screen bg-slate-950 text-slate-100">
  <div id="toasts" class="fixed z-50 top-4 left-1/2 -translate-x-1/2 w-[min(92vw,560px)] space-y-2"></div>

  <!-- LOGIN VIEW -->
  <section id="view-login" class="min-h-screen flex items-center justify-center p-5">
    <div class="w-full max-w-md">
      <div class="rounded-3xl bg-slate-900/60 border border-white/10 shadow-xl p-6">
        <div class="flex items-center gap-3">
          <div class="h-11 w-11 rounded-2xl bg-white/10 flex items-center justify-center">
            <span class="text-xl">▦</span>
          </div>
          <div>
            <h1 class="text-xl font-semibold tracking-tight">STILL Player</h1>
            <p class="text-sm text-slate-300">Lokāls Web UI · pārvaldībai</p>
          </div>
        </div>

        <div class="mt-6 space-y-3">
          <label class="block">
            <span class="text-sm text-slate-200">Lietotājvārds</span>
            <input id="loginUser" class="input" placeholder="still" autocomplete="username" />
          </label>
          <label class="block">
            <span class="text-sm text-slate-200">Parole</span>
            <input id="loginPass" class="input" placeholder="still" type="password" autocomplete="current-password" />
          </label>

          <button id="btnLogin" class="btn btn-primary w-full mt-2">Ieiet</button>

          <div class="rounded-2xl bg-white/5 border border-white/10 p-4 mt-4">
            <p class="text-sm text-slate-200 font-medium">Pirmais login</p>
            <p class="text-xs text-slate-300 mt-1">
              Noklusējums: <span class="font-semibold">still / still</span>. Pēc pirmās ieiešanas iestatījumos nomaini:
              Web paroli un Hotspot SSID/paroli.
            </p>
          </div>
        </div>
      </div>

      <p class="text-xs text-slate-400 mt-4 text-center">
        Atver lokālo adresi ierīces tīklā (piem. 192.168.x.x)
      </p>
    </div>
  </section>

  <!-- APP VIEW -->
  <section id="view-app" class="hidden min-h-screen">
    <header class="sticky top-0 z-40 backdrop-blur bg-slate-950/70 border-b border-white/10">
      <div class="mx-auto w-full max-w-6xl px-4 py-3 flex items-center justify-between gap-3">
        <div class="flex items-center gap-3 min-w-0">
          <div class="h-10 w-10 rounded-2xl bg-white/10 flex items-center justify-center shrink-0">▶</div>
          <div class="min-w-0">
            <div class="flex items-center gap-2 min-w-0">
              <h2 id="deviceName" class="font-semibold truncate">STILL</h2>
              <span class="pill">Local</span>

              <!-- Battery -->
              <div class="batteryWrap ml-2" title="Battery">
                <div class="battery" aria-label="Battery">
                  <div id="batteryFill" class="batteryFill"></div>
                  <div class="batteryCap"></div>
                  <div id="batteryPctIn" class="batteryPctIn">—%</div>
                </div>
              </div>
            </div>

            <p class="text-xs text-slate-400 truncate">
              Aktīvā kasete: <span id="currentCassetteLabel" class="text-slate-200">—</span>
              <span id="lockPill" class="pill ml-2 hidden">LOCK</span>
              <span class="pill ml-2">Hotspot: <span id="hotspotLabel" class="ml-1 text-slate-100">—</span></span>
            </p>
          </div>
        </div>

        <div class="flex items-center gap-2">
          <button id="btnOpenSettings" class="btn btn-ghost">Iestatījumi</button>
          <button id="btnLogout" class="btn btn-ghost">Iziet</button>
        </div>
      </div>
    </header>

    <main class="mx-auto w-full max-w-6xl px-4 py-6 grid grid-cols-12 gap-4">
      <!-- LEFT -->
      <section class="col-span-12 lg:col-span-7 space-y-4">
        <!-- Cassettes -->
        <div class="card">
          <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3">
            <div>
              <h3 class="text-lg font-semibold">Kasetes</h3>
              <p class="text-sm text-slate-300">Vari izveidot vairākas kasetes un pārslēgties starp tām.</p>
            </div>
            <div class="flex items-center gap-2">
              <button id="btnNewCassette" class="btn btn-primary">+ Jauna kasete</button>
            </div>
          </div>

          <div class="mt-4 sm:hidden">
            <label class="block">
              <span class="text-sm text-slate-200">Izvēlies kaseti</span>
              <select id="cassetteSelect" class="input"></select>
            </label>
          </div>

          <div id="cassetteList" class="mt-4 hidden sm:block space-y-2"></div>

          <div class="mt-4 rounded-2xl bg-white/5 border border-white/10 p-4 flex items-center justify-between gap-3">
            <div class="min-w-0">
              <p class="text-xs text-slate-400">Aktīvā kasete</p>
              <p id="cassetteMetaLine" class="text-sm font-semibold truncate">—</p>
            </div>
            <div class="flex items-center gap-2">
              <button id="btnRenameCassette" class="btn btn-ghost btn-sm">Pārdēvēt</button>
              <button id="btnToggleLock" class="btn btn-ghost btn-sm">Lock</button>
            </div>
          </div>

          <!-- Battery demo (vari izņemt) -->
          <div class="mt-4 rounded-2xl bg-white/5 border border-white/10 p-4">
            <div class="flex items-center justify-between gap-3">
              <div class="min-w-0">
                <p class="text-xs text-slate-400">Battery demo (UI)</p>
                <p class="text-sm text-slate-200">Pabīdi, lai redzētu krāsu un pildījumu.</p>
              </div>
              <div class="w-40">
                <input id="batterySlider" type="range" min="0" max="100" value="74" class="w-full">
              </div>
            </div>
          </div>
        </div>

        <!-- Cassette editor -->
        <div class="card">
          <div>
            <h3 class="text-lg font-semibold">Kasetes skats</h3>
            <p class="text-sm text-slate-300">
              2 puses · katrā stingri <span class="font-semibold">10 dziesmas</span>.
              Pievieno no Library ar <span class="kbd">+A</span>/<span class="kbd">+B</span>.
              A/B pusēs <span class="kbd">Dzēst</span> pārvieto atpakaļ uz Library.
            </p>
          </div>

          <div class="mt-4 grid grid-cols-1 md:grid-cols-2 gap-3">
            <div class="panel">
              <div class="flex items-start justify-between gap-2">
                <div class="min-w-0">
                  <div class="flex items-center gap-2">
                    <span class="pill pill-side">Side A</span>
                    <span id="countA" class="text-xs text-slate-300">0/10</span>
                  </div>
                  <label class="block mt-2">
                    <span class="text-xs text-slate-400">NFC ID (A)</span>
                    <input id="nfcA" class="input input-sm mt-1" placeholder="04A1B2C3D4" />
                  </label>
                </div>
                <div class="flex items-center gap-2 shrink-0">
                  <button class="btn btn-ghost btn-sm" data-action="clearSide" data-side="A">Notīrīt</button>
                </div>
              </div>

              <div class="dropzone list-scroll mt-3">
                <div id="listA" class="space-y-2"></div>
                <div id="emptyA" class="emptyhint">Side A tukšs</div>
              </div>
            </div>

            <div class="panel">
              <div class="flex items-start justify-between gap-2">
                <div class="min-w-0">
                  <div class="flex items-center gap-2">
                    <span class="pill pill-side">Side B</span>
                    <span id="countB" class="text-xs text-slate-300">0/10</span>
                  </div>
                  <label class="block mt-2">
                    <span class="text-xs text-slate-400">NFC ID (B)</span>
                    <input id="nfcB" class="input input-sm mt-1" placeholder="04D4C3B2A1" />
                  </label>
                </div>
                <div class="flex items-center gap-2 shrink-0">
                  <button class="btn btn-ghost btn-sm" data-action="clearSide" data-side="B">Notīrīt</button>
                </div>
              </div>

              <div class="dropzone list-scroll mt-3">
                <div id="listB" class="space-y-2"></div>
                <div id="emptyB" class="emptyhint">Side B tukšs</div>
              </div>
            </div>
          </div>
        </div>

        <!-- Bluetooth -->
        <div class="card">
          <div class="flex items-center justify-between gap-3">
            <div>
              <h3 class="text-lg font-semibold">Bluetooth ierīces</h3>
              <p class="text-sm text-slate-300">Meklē, sapāro un aizmirsti ierīces. (UI demo)</p>
            </div>
            <button id="btnScanBT" class="btn btn-primary">Meklēt</button>
          </div>

          <div class="mt-4 grid grid-cols-1 md:grid-cols-2 gap-3">
            <div class="panel">
              <div class="flex items-center justify-between">
                <p class="text-sm font-semibold">Atrastas</p>
                <span id="btScanState" class="pill">Idle</span>
              </div>
              <div id="btFound" class="mt-3 space-y-2"></div>
              <div id="btFoundEmpty" class="emptyhint">Spied “Meklēt”</div>
            </div>

            <div class="panel">
              <div class="flex items-center justify-between">
                <p class="text-sm font-semibold">Sapārotas</p>
                <span id="btPairedCount" class="pill">0</span>
              </div>
              <div id="btPaired" class="mt-3 space-y-2"></div>
              <div id="btPairedEmpty" class="emptyhint">Nav sapārotu ierīču</div>
            </div>
          </div>
        </div>
      </section>

      <!-- RIGHT: Library -->
      <aside class="col-span-12 lg:col-span-5 space-y-4">
        <div class="card">
          <div class="flex items-start justify-between gap-3">
            <div>
              <h3 class="text-lg font-semibold">Library</h3>
              <p class="text-sm text-slate-300">Dziesmas, kas nav kasetē. Pievieno uz A/B ar pogām.</p>
            </div>
            <button id="btnAddMockSongs" class="btn btn-ghost">+ Demo</button>
          </div>

          <div class="mt-4 flex gap-2">
            <input id="searchLibrary" class="input" placeholder="Meklēt dziesmu..." />
            <button id="btnUploadMock" class="btn btn-primary">Upload (demo)</button>
          </div>

          <div class="dropzone list-scroll mt-4">
            <div id="libraryList" class="space-y-2"></div>
            <div id="libraryEmpty" class="emptyhint">Library tukšs. Spied “+ Demo”.</div>
          </div>

          <div class="mt-4 flex items-center justify-between text-xs text-slate-400">
            <span>Mobilais: pievieno ar +A/+B. Secību maini A/B pusē ar vilkšanu.</span>
            <span id="libraryCount">0</span>
          </div>
        </div>
      </aside>
    </main>
  </section>

  <!-- MODALS -->
  <div id="modalBackdrop" class="hidden fixed inset-0 z-50 bg-black/60 backdrop-blur-sm"></div>

  <!-- Settings modal -->
  <div id="modalSettings" class="hidden fixed inset-0 z-50 p-4 flex items-center justify-center">
    <div class="w-full max-w-lg rounded-3xl bg-slate-900 border border-white/10 shadow-2xl p-6">
      <div class="flex items-start justify-between gap-3">
        <div>
          <h3 class="text-lg font-semibold">Iestatījumi</h3>
          <p class="text-sm text-slate-300">Maini Web un Hotspot noklusējumus.</p>
        </div>
        <button class="btn btn-ghost btn-sm" data-close-modal>✕</button>
      </div>

      <div class="mt-5 space-y-5">
        <div class="rounded-2xl bg-white/5 border border-white/10 p-4">
          <p class="text-sm font-semibold text-slate-100">Web UI</p>
          <label class="block mt-3">
            <span class="text-sm text-slate-200">Ierīces nosaukums</span>
            <input id="settingsDeviceName" class="input" placeholder="STILL" />
          </label>

          <div class="grid grid-cols-1 sm:grid-cols-2 gap-3 mt-3">
            <label class="block">
              <span class="text-sm text-slate-200">Jauna Web parole</span>
              <input id="settingsNewPass" class="input" type="password" placeholder="••••••••" />
            </label>
            <label class="block">
              <span class="text-sm text-slate-200">Atkārtot Web paroli</span>
              <input id="settingsNewPass2" class="input" type="password" placeholder="••••••••" />
            </label>
          </div>
        </div>

        <div class="rounded-2xl bg-white/5 border border-white/10 p-4">
          <p class="text-sm font-semibold text-slate-100">Hotspot</p>

          <label class="block mt-3">
            <span class="text-sm text-slate-200">Hotspot SSID (nosaukums)</span>
            <input id="settingsHotspotSsid" class="input" placeholder="still" />
          </label>

          <div class="grid grid-cols-1 sm:grid-cols-2 gap-3 mt-3">
            <label class="block">
              <span class="text-sm text-slate-200">Jauna Hotspot parole</span>
              <input id="settingsHotspotPass" class="input" type="password" placeholder="••••••••" />
            </label>
            <label class="block">
              <span class="text-sm text-slate-200">Atkārtot Hotspot paroli</span>
              <input id="settingsHotspotPass2" class="input" type="password" placeholder="••••••••" />
            </label>
          </div>

          <p class="text-xs text-slate-400 mt-3">
            Piezīme: UI demo. Reālajā sistēmā backend pielietos hostapd/dnsmasq iestatījumus.
          </p>
        </div>

        <div class="flex items-center justify-end gap-2 pt-1">
          <button class="btn btn-ghost" data-close-modal>Atcelt</button>
          <button id="btnSaveSettings" class="btn btn-primary">Saglabāt</button>
        </div>
      </div>
    </div>
  </div>

  <!-- New cassette modal -->
  <div id="modalNewCassette" class="hidden fixed inset-0 z-50 p-4 flex items-center justify-center">
    <div class="w-full max-w-lg rounded-3xl bg-slate-900 border border-white/10 shadow-2xl p-6">
      <div class="flex items-start justify-between gap-3">
        <div>
          <h3 class="text-lg font-semibold">Jauna kasete</h3>
          <p class="text-sm text-slate-300">Ievadi nosaukumu un NFC ID katrai pusei.</p>
        </div>
        <button class="btn btn-ghost btn-sm" data-close-modal>✕</button>
      </div>

      <div class="mt-5 space-y-3">
        <label class="block">
          <span class="text-sm text-slate-200">Kasetes nosaukums</span>
          <input id="newCassetteName" class="input" placeholder="Piem.: Road Trip 01" />
        </label>

        <div class="grid grid-cols-1 sm:grid-cols-2 gap-3">
          <label class="block">
            <span class="text-sm text-slate-200">NFC ID (A)</span>
            <input id="newCassetteNfcA" class="input" placeholder="04A1B2C3D4" />
          </label>
          <label class="block">
            <span class="text-sm text-slate-200">NFC ID (B)</span>
            <input id="newCassetteNfcB" class="input" placeholder="04D4C3B2A1" />
          </label>
        </div>

        <div class="flex items-center justify-end gap-2 pt-2">
          <button class="btn btn-ghost" data-close-modal>Atcelt</button>
          <button id="btnCreateCassette" class="btn btn-primary">Izveidot</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Rename cassette modal -->
  <div id="modalRename" class="hidden fixed inset-0 z-50 p-4 flex items-center justify-center">
    <div class="w-full max-w-lg rounded-3xl bg-slate-900 border border-white/10 shadow-2xl p-6">
      <div class="flex items-start justify-between gap-3">
        <div>
          <h3 class="text-lg font-semibold">Pārdēvēt kaseti</h3>
          <p class="text-sm text-slate-300">Tikai nosaukums (NFC rediģē pie pusēm).</p>
        </div>
        <button class="btn btn-ghost btn-sm" data-close-modal>✕</button>
      </div>

      <div class="mt-5 space-y-3">
        <label class="block">
          <span class="text-sm text-slate-200">Nosaukums</span>
          <input id="cassetteNameInput" class="input" placeholder="Kasete" />
        </label>

        <div class="flex items-center justify-end gap-2 pt-2">
          <button class="btn btn-ghost" data-close-modal>Atcelt</button>
          <button id="btnSaveCassetteName" class="btn btn-primary">Saglabāt</button>
        </div>
      </div>
    </div>
  </div>

  <script src="./app.js"></script>
</body>
</html>
